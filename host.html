<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Host | Permainan ADIL</title>
<link href="https://cdn.jsdelivr.net/npm/tailwindcss@3.3.2/dist/tailwind.min.css" rel="stylesheet">
<style>
  body {
    background: radial-gradient(circle at center, #022c22, #011a12);
    color: #d1fae5;
    font-family: 'Poppins', sans-serif;
    text-align: center;
    min-height: 100vh;
    padding: 2rem;
  }
  #current {
    font-size: 6rem;
    font-weight: 900;
    color: #6ee7b7;
    text-shadow: 0 0 40px #10b981;
    margin-top: 1rem;
    transition: all 0.4s ease;
  }
  .pop {
    transform: scale(1.2);
    text-shadow: 0 0 60px #10b981;
  }
  .rolling {
    animation: roll 0.1s linear infinite;
  }
  @keyframes roll {
    0% { opacity: 0.2; transform: scale(0.9); }
    50% { opacity: 1; transform: scale(1.1); }
    100% { opacity: 0.2; transform: scale(0.9); }
  }
  .btn {
    background: #10b981;
    color: white;
    font-weight: bold;
    border-radius: 0.75rem;
    padding: 0.8rem 2rem;
    margin: 1rem;
    transition: all 0.25s ease;
  }
  .btn:hover { background: #34d399; transform: scale(1.05); }
  #history {
    background: rgba(6,95,70,0.3);
    border-radius: 1rem;
    padding: 1rem;
    margin-top: 1.5rem;
    text-align: left;
    max-width: 600px;
    margin-inline: auto;
  }
  #history h3 {
    text-align: center;
    font-weight: bold;
    color: #a7f3d0;
  }
  .entry {
    display: inline-block;
    background: rgba(16,185,129,0.2);
    padding: 0.5rem 0.8rem;
    border-radius: 0.5rem;
    margin: 0.3rem;
    font-weight: 700;
    color: #bbf7d0;
  }
</style>
</head>
<body>

<h1 class="text-3xl font-bold text-emerald-300 mb-4">üéôÔ∏è Host Permainan ADIL</h1>

<div id="current">--</div>

<div>
  <button id="btnKocok" class="btn">üé≤ KOCOK ANGKA</button>
  <button id="btnReset" class="btn bg-red-600 hover:bg-red-700">‚ôªÔ∏è RESET</button>
</div>

<div id="history">
  <h3>Riwayat Kocok</h3>
  <div id="list"></div>
</div>

<script>
  const hurufADIL = ['A', 'D', 'I', 'L'];
  let angkaBelumKeluar = Array.from({length: 50}, (_, i) => i + 1);
  let riwayat = JSON.parse(localStorage.getItem('adil-history')) || [];

  const currentEl = document.getElementById('current');
  const listEl = document.getElementById('list');
  const kocokBtn = document.getElementById('btnKocok');

  let rollingInterval = null;

  const rollSound = new Audio("https://cdn.pixabay.com/download/audio/2022/03/15/audio_0dbf8c7a57.mp3?filename=rolling-dice-1-26694.mp3");
  const dingSound = new Audio("https://cdn.pixabay.com/download/audio/2021/08/04/audio_1c9a2eb3f8.mp3?filename=correct-2-46134.mp3");

  function tampilRiwayat() {
    listEl.innerHTML = '';
    riwayat.forEach(item => {
      const div = document.createElement('div');
      div.className = 'entry';
      div.textContent = `${item.huruf}:${String(item.angka).padStart(2, '0')}`;
      listEl.appendChild(div);
    });
  }

  function animasiKocok() {
    let counter = 0;
    rollingInterval = setInterval(() => {
      const huruf = hurufADIL[Math.floor(Math.random() * 4)];
      const angka = Math.floor(Math.random() * 50) + 1;
      currentEl.textContent = `${huruf}:${String(angka).padStart(2, '0')}`;
      currentEl.classList.add("rolling");
      counter++;
      if (counter > 15) { // ~1.5 detik animasi
        clearInterval(rollingInterval);
        currentEl.classList.remove("rolling");
        hasilKocok();
      }
    }, 100);
  }

  function hasilKocok() {
    if (angkaBelumKeluar.length === 0) {
      alert('Semua angka sudah keluar!');
      return;
    }

    const huruf = hurufADIL[Math.floor(Math.random() * 4)];
    const index = Math.floor(Math.random() * angkaBelumKeluar.length);
    const angka = angkaBelumKeluar.splice(index, 1)[0];

    const hasil = { huruf, angka };
    localStorage.setItem('adil-last', angka); 
    localStorage.setItem('adil-last-huruf', huruf);

    // efek hasil
    currentEl.textContent = `${huruf}:${String(angka).padStart(2, '0')}`;
    currentEl.classList.add("pop");
    rollSound.pause(); rollSound.currentTime = 0;
    dingSound.play();

    setTimeout(() => currentEl.classList.remove("pop"), 800);

    // masukkan ke riwayat setelah 2 detik
    setTimeout(() => {
      riwayat.unshift(hasil);
      localStorage.setItem('adil-history', JSON.stringify(riwayat));
      tampilRiwayat();
    }, 2000);
  }

  kocokBtn.addEventListener('click', () => {
    rollSound.currentTime = 0;
    rollSound.play();
    animasiKocok();
  });

  document.getElementById('btnReset').addEventListener('click', () => {
    if (confirm('Reset semua hasil kocokan?')) {
      angkaBelumKeluar = Array.from({length: 50}, (_, i) => i + 1);
      riwayat = [];
      localStorage.removeItem('adil-last');
      localStorage.removeItem('adil-last-huruf');
      localStorage.removeItem('adil-history');
      currentEl.textContent = '--';
      listEl.innerHTML = '';
    }
  });

  tampilRiwayat();
</script>
</body>
</html>
